简述
使用Unity2D制作一个类似于杀戮尖塔的回合制卡牌游戏，将该游戏rougelike的元素改变为使用技能树获取新的卡牌和角色的强化效果（遗物系统）。


战斗场景UI
  

UI Mock Up Reference
战斗场景UI层级结构说明 - 至少场景中的UI会包含这些内容
1. 顶部信息栏
* 位置: 屏幕顶部居中
* 显示内容:
   * 当前回合数 (Round 2)
   * 回合数展示位置标识


* 位置: 屏幕左上角
* 显示内容:
   * 怀表&本回合怀表结果
2. 主战斗区域 (中央)
* 背景: 伪3D战斗场景
* 包含元素:
   * 玩家角色站位: 左侧区域，显示玩家控制的角色精灵
   * 敌人角色站位: 右侧区域，可显示多个敌方角色
   * 角色信息显示:
      * 显示角色和敌人的Prefab
   * 可释放卡牌的区域: 中央可交互的释放区域
3. 右侧速度/行动顺序条
* 位置: 屏幕右侧垂直排列
* 功能: 显示战斗行动顺序
* 速度条Node Prefab显示内容:
   * 速度值
   * 行动卡牌名称
   * 通过角色头像区分不同角色的行动
   * 速度条显示区域标识
4. 底部卡牌区域
* 位置: 屏幕底部
* 分为多个子区域: 4.1 左下角 - 牌库信息区
   * 丢弃区 & 丢弃区内卡牌数量显示
   * 抽牌堆图标&库内剩余卡牌数量显示
* 4.2 中央 - 手牌展示区
   * 固有手牌槽位
   * 其余手牌槽位
* 4.3 右下角 - 输出槽位和回合控制
   * 槽位效果对比显示：
      * 三个槽位附带不一样的效果；
      * 在槽位上使用TextMeshProUGUI组件展示效果描述；
   * 速度展示: 在三个槽位的上方，有三个速度展示UI组件（Image背景，TextMeshProUGUI文字），展示放入输出卡槽的卡牌受槽位效果影响后的最终速度值；
   * 卡牌输出槽位: 展示拖入输出的卡牌后最终速度值以及效果数值
   * 回合控制:
      * 回退按钮（Revert）
      * 结束回合按钮（END）


游戏回合制流程
开始战斗（流程）
1. 检查场景id，确认战斗背景id；
2. 检查输出槽位装置id，确认输出槽位效果；
3. 展示怀表Panel，确定这回合怀表结果；
4. 播放对应结果的怀表转动动画；
5. 展示对应的怀表Sprite；
6. 在Panel的一个TextMeshProUGUI部分展示该结果对应的效果描述（怀表Data）；
7. 玩家可以点击屏幕，继续游戏，Panel消失进入主场景；
8. 玩家获得本回合的初始手牌:
   1. 从任何位置（无论他们在哪）获取所有固有手牌，将根据id顺序放入固有手牌槽位中；
   2. 随后，从牌库中抽取3张卡牌加入其他手牌的槽位；
9. 触发怀表带来的本回合的场地效果逻辑；
10. 进入下一阶段；


玩家规划阶段（可以进行的行为以及相关机制）
1. 玩家可以检视自己的所有手牌；
   1. 鼠标滑动到卡牌上方会有一个浮动的效果，表示卡牌可以被交互；
   2. 点击卡牌会打开检视Panel，上面会展示卡牌完整的信息，并且有个关闭的按钮。在检视Panel显示期间，玩家无法影响除了Panel以外的内容，以免出现不必要的bug。玩家在这个点击关闭按钮返回战斗场景；
2. 玩家可以将手牌拖入输出槽位作为预备使用的卡牌；
   1. 玩家可以按下revert按钮将已经放入槽位的卡牌退回手牌中；
   2. 拖入输出槽位的卡牌会受到槽位的效果所影响，速度值变化后的最终值会展示在该卡所在的输出槽位的UI组件上；
   3. 玩家可以点击已经在输出槽位中的卡牌进行检视，会展开检视Panel。这个时候检视Panel中的卡牌的信息会根据输出槽位效果的影响而改变（主要是速度值和造成效果的数值）；
3. 玩家可以看见敌人/怪物的行动意图；
4. （如果同时存在多个敌人）玩家可以点击敌人切换目标，会有一个Aim的图标浮于敌人的立绘之上，代表玩家当前瞄准的是这个敌人；
   1. 当玩家将一张卡牌拖入输出槽位时，根据当前Aim锁定的敌人，确定这张卡牌的攻击目标；
5. 按下回合结束按钮会出现两种情况：
   1. 没有填满输出槽位，会出现一个窗口进行提示，有两个按键，一个是确认结束，一个是返回；
   2. 填满所有槽位，结束当前阶段，进入下一阶段；


战斗阶段
1. 根据所有卡牌和敌方行为的速度值，在行动条的UI区域规划行动顺序，有下面这些特殊规则：
   1. 若情况为同样速度值，则默认敌方先行动；
   2. 若卡牌速度值相同，则根据卡牌种类Type：Swift - Normal - Strong - None的顺序规划行动顺序；
   3. 行动Node在行动条UI区域依次排列；
   4. 当鼠标滑动到对应的行动Node上时，会浮现该行动对应的卡牌data的完整卡牌的sprite；
2. 整理完行动顺序，双方会根据这个行动顺序自动开始行动并处理战斗的逻辑，流程应该是“速度条上Node进行一定向上的位移 - 对应的角色播放对应的动画 - 触发行动带来的效果，在对应位置进行显示”，行动过程中有下面这些特殊规则：
   1. Perfect Deflect - 当双方行为的速度值相同，但是卡牌Type之间存在克制，被克制的一方行动会被打断，触发Perfect Deflect的一方的行为会提前并且立刻执行；具体流程为”
      1. 被克制的一方先行动 - 速度条上Node进行一定向上的位移 - 播放对应角色行动的动画 - 触发Perfect Deflect - 显示Perfect Deflect的弹窗（可编辑时间后自动消失） - 速度条上触发Perfect Deflect一方的Node立刻移动到被克制的一方的行动Node之上 - 播放触发Perfect Deflect一方的行动动画 - 触发行动带来的效果，在对应位置进行显示
   2. 属性反应 - 如果这一次行动触发了属性反应，则先结算属性反应的效果，再结算伤害；
   3. 如果这一次行动时，目标拥有任意有关的词条效果，优先计算词条效果的影响，再得出受效果影响后这次行动的数值（伤害/护盾值/效果值）；
3. 当所有行动条上所有的行动都进行完毕之后，结束战斗阶段，进入下一阶段；


结算阶段


1. 结算各个效果词条的回合结束时效果；
2. 玩家和敌人的护甲值不会在回合结束时被清除；
3. 将玩家手中除了固有卡牌以外的所有未使用卡牌放入弃牌区；


战斗结束
1. 当任意一方的生命值归零（所有成员全部死亡），结束战斗
   1. 立刻停止一切在进行行为；
   2. （玩家存活）显示战斗胜利Panel；
   3. （玩家死亡）显示战斗失败Panel；
   4. Panel展示期间玩家无法影响除了Panel以外的其他内容；
Data数据
需要使用scriptable object预存一些data：
1.主角（角色）（至少会包含）：
1. id
2. 角色HP
3. 初始护盾值
4. 角色的Prefab
5. 相关音效 - （没有护盾时）受伤；（有护盾时）受伤；攻击；恢复生命；获得护盾


角色的prefab会包含：
角色立绘的组建；
播放动画的组建以及相关Trigger（暂定有近战攻击，释放法术，Idle待机，死亡，受伤五种种）；
跟随角色的Canvas，其中包含：
血条slide bar；
（不一定会使用的血条TextMeshProUGUI）；
护盾的slider bar（在没有护盾时不会显示）；
（不一定会使用的护盾值TextMeshProUGUI）；
在UI层显示状态Icon的位置；
受到伤害/恢复生命/获得护盾时，显示该数字的TextMeshProUGUI；


2.卡牌（至少会包含）：
1. id
2. 速度值
3. 插绘
4. 类型 Class - 攻击/技能/能力
5. 种类 Type - 迅捷Swift/坚毅Strong/中庸Normal/无None
6. 属性 Attribute - 土Earth/气Air/火Flame/水Water/物理Physical/混沌Chaos
7. 效果 - 是否为基础固有卡牌/是否造成伤害/是否是群体伤害（对所有敌人造成伤害）/是否恢复生命/是否获得护甲/是否为自己获得任意词条效果，如果获得获得多少层/是否可以（在规划阶段）直接释放（不计入回合制流程，不需要放进输出位置）；
8. 效果描述 - 展示在卡面上的文字
9. 完整卡牌的sprite
10. 对应的动画Trigger


卡牌的Prefab会包含（卡牌只存在于UI层）：
卡牌立绘的组建（在制作卡牌立绘的时候其上就会有插绘，类型，种类，属性这些内容在上面）；
可以被拖动或者影响的相关组件；
卡牌速度值的TextMeshProUGUI；
卡牌效果介绍的TextMeshProUGUI；
（可能会有多个）卡牌附带的额外词条效果介绍的Panel以及相关的Image，TextMeshRroUGUI组件；


3.怪物（至少会包含）：
1. id
2. 怪物HP
3. 初始护盾值
4. 怪物的Prefab
5. 相关音效 - （没有护盾时）受伤；（有护盾时）受伤；攻击；恢复生命；获得护盾
6. 技能List - 每一个技能我可以编辑他的对应卡牌id/速度值/类型/种类/属性/效果（是否造成伤害/是否恢复生命/是否获得护甲/是否为自己获得任意词条效果，如果获得获得多少层）
7. 释放技能的行动模式：
   1. 第一回合是否释放特殊技能（技能List中编号几的技能）；
   2. 一回合是否为多个行动；
   3. （如果释放过特殊技能，除却它）接下来的对局中随机释放List中的技能还是按照List中的顺序循环释放技能；


怪物的prefab会包含：
怪物立绘的组建；
播放动画的组建以及相关Trigger（暂定有近战攻击，释放法术，Idle待机，死亡，受伤五种）；
跟随怪物的Canvas，其中包含：
血条slide bar；
（不一定会使用的血条TextMeshProUGUI）；
护盾的slider bar（在没有护盾时不会显示）；
（不一定会使用的护盾值TextMeshProUGUI）；
在UI层显示状态Icon的位置；
受到伤害/恢复生命/获得护盾时，显示该数字的TextMeshProUGUI；
显示行动意图的区域，里面是行动意图Prefab的位置（最少为1个，最多为3个）


行动意图的Prefab会包含：
        行动的立绘Image组件；
行动技能的速度值TextMeshProUGUI；
行动技能的类型TextMeshProUGUI；
行动技能的种类TextMeshProUGUI；
行动技能的属性TextMeshProUGUI；
（如果是攻击类型）行动技能的具体伤害；




（基础伤害+力量+临时力量）


4.词条效果
游戏中有如下的词条效果，需要记录他们的id；icon sprtie；具体效果；效果描述：
1. 火元素残留 1 - 下个回合结束时，失去1层火元素残留；
2. 水元素残留 1 - 下个回合结束时，失去1层水元素残留；
3. 土元素残留 1 - 下个回合结束时，失去1层土元素残留；
4. 气元素残留 1 - 下个回合结束时，失去1层气元素残留；
5. 力量 1 - 在该局对战接下来的时间里，所有的攻击力+1；
6. 临时力量 1 - 在这一回合内，所有的攻击力+1，回合结束时失去所有临时力量；
7. 虚弱 1 - 在这一回合内，造成的伤害减少25%，向下取整（最低为1），回合结束时失去1层虚弱；
8. 铸甲 1 - 在这一回合内，获得的护甲值提升25%（向上取整），回合结束时失去1层铸甲；
9. 碎甲 1 - 在这一回合内，获得的护甲值减少25%，向下取整（最低为1），回合结束时失去1层碎甲；
10. 再生 1 - 回合结束时，根据层数恢复等量生命值，回合结束时失去1层再生；
11. 毒素 1 - 拥有“毒素”时恢复效果扣除25%，向下取整（最低为1）。回合结束时，根据层数扣除等量生命值，回合结束时失去1层毒素；
12. 冰冻 - （无法叠加层数）取消受影响目标本回合所有行动，回合结束时失去冰冻；
13. 失准 - （无法叠加层数）受影响目标攻击命中率降低50%，下个回合结束时，失去失准；
14. 坚固 1 - 受影响目标受到的伤害减少25%，向上取整（至少受到1点伤害），且无法被挂上任意元素残留，下回合结束时，失去1层坚固；
15. 脆弱 1 - 受影响目标受到的下一次攻击伤害提升50%，向上取整。如果攻击类型为“物理”，则，这一次攻击伤害提升100%，下回合结束时，失去1层脆弱；
16. 隐匿 - （无法叠加层数）闪避下一次受到的攻击。下回合结束时，失去隐匿，若效果结束时没有被触发，重新为自己挂上水元素残留；
17. 炸弹 - （无法叠加层数）3回合后爆炸，造成当前生命值20%的伤害，向上取整（有最低固有伤害6）。效果存在期间目标每受到一次元素伤害减少1回合等待时间；


词条效果（例如杀戮尖塔中的“力量”）Prefab会包含：
词条效果的Icon；
词条效果的层数TextMeshProUGUI（炸弹的倒计时同样使用这个文字组件，只不过改变一下颜色）；
介绍该效果的的Panel以及相关的TextMeshProUGUI组件；


5.怀表轮盘效果
怀表转动时会根据获得的结果出现如下几种战场效果（本回合，立即发动）：
1 - 额外抽取一张卡牌；
2 - 为没有元素残留的敌人挂上1种随机元素残留；
3 - 所有敌方受到2点随机元素伤害；
4 - 本回合“无”类型的卡牌效果提升25%，向上取整；
5 - 获得一张可以编辑id的卡牌，无论回合结束时它在哪里，丢弃它；
6 - 玩家获得1层随机增益状态（力量，铸甲，再生）；
需要存储的信息有：id；对应的动画Trigger；对应的怀表Sprite；对应的数字Sprite；具体效果；效果描述


怀表在场景中最终展示时的prefab会包含：
1. 本回合抽中的数字的Icon Image组件；
2. 介绍本回合战场效果的的Panel以及相关的TextMeshProUGUI组件；


6. 输出卡牌系统
需要记录的数据有：
1. id
2. 名字；
3. 立绘sprite
4. 有几个槽位
5. 每个槽位对于速度值影响是什么；
6. 每个槽位对于效果的影响是什么（数值影响后的行动效果数值最低永远为1，不能低于这个数值）；




7. 属性反应机制
1. 元素残留（不要属于正面状态，也不属于异常状态）- 每次使用元素攻击/效果会为造成影响的目标挂上”元素残留“的效果（四种元素分别对应四种残留）
2. 属性反应，使用元素攻击时，受影响单位有“元素残留”的效果，则会触发属性反应：
   1. 火x水
对敌人：蒸汽爆炸，为受影响目标挂上“炸弹”；


对自己：雾影，获得buff“隐匿”；


   2. 火x土
对敌人：玻璃化，触发效果的目标为敌人时，为敌人挂上“脆弱”debuff；


对自己：熔甲，触发目标为自己时，获得2点“铸甲”并获得4点护盾


   3. 火x气
对敌人：爆燃，触发时，这一次攻击造成的伤害提升50%，并未目标挂上1层虚弱；


对自己：焰气，触发目标为自己时，受到1点伤害，获得3层力量


   4. 水x土
对敌人：泥沼，触发效果的目标为敌人时，为敌人挂上6层“毒素”debuff；


对自己：滋养，触发目标为自己时，获得5层“再生”buff；


   5. 水x气
对敌人：冰霜，下回合降低受影响目标所有2点出手速度值，有30%概率触发“冰冻”debuff
”冰冻“ - 受影响目标下回合无法行动；


对自己：霜甲：触发目标为自己时，清除自身受到一种debuff并恢复4点HP；


   6. 土x气
对敌人：尘暴，为受影响目标挂上“失准”debuff；


对自己：岩肤：触发目标为自己时，获得“坚固”buff；






8. 玩家deck数据
需要有一个相关功能来记录玩家的deck里面是哪些卡牌。然后预留一个端口给以后有功能能够给这个deck添加卡牌和减少卡牌；
玩家会有多个deck，预留端口，后期内容会有在进入正式战斗之前会让玩家选择一个自己的卡组再进入战斗，同时会有页面能够编辑自己的卡组